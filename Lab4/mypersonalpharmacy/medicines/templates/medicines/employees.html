{% extends 'medicines/layout.html' %}
{% block title %}Сотрудники{% endblock %}

{% block content %}
    <h1 align="center">Наши сотрудники</h1>

    <div class="employees-container">
        {% for p in posts %}
            <div class="employee-card-wrapper">
                <div class="employee-card">
                    {% if p.photo %}
                        <img src="{{ p.photo.url }}" alt="{{ p.name }}">
                    {% endif %}
                    <div class="employee-info">
                        <p>{{ p.name }}</p>
                        <p>{{ p.description }}</p>
                        <p>{{ p.phone_number }}</p>
                        <p>{{ p.email }}</p>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const cardWrappers = document.querySelectorAll(".employee-card-wrapper");

            cardWrappers.forEach(cardWrapper => {
                const card = cardWrapper.querySelector(".employee-card");

                cardWrapper.addEventListener("mousemove", event => {
                    const [x, y] = [event.offsetX, event.offsetY];
                    const rect = cardWrapper.getBoundingClientRect();
                    const [width, height] = [rect.width, rect.height];
                    const middleX = width / 2;
                    const middleY = height / 2;
                    const offsetX = ((x - middleX) / middleX) * 25;
                    const offsetY = ((y - middleY) / middleY) * 25;
                    const offX = 50 + ((x - middleX) / middleX) * 25;

                    const offY = 10;

                    card.style.setProperty("--rotateX", -1 * offsetX + "deg");
                    card.style.setProperty("--rotateY", 1 * offsetY + "deg");
                    card.style.setProperty("--posx", offX + "%");
                    card.style.setProperty("--posy", offY + "%");
                });

                cardWrapper.addEventListener("mouseleave", eve => {
                    card.style.animation = "reset-card 1s ease";
                    card.addEventListener("animationend", e => {
                        card.style.animation = "unset";
                        card.style.setProperty("--rotateX", "0deg");
                        card.style.setProperty("--rotateY", "0deg");
                        card.style.setProperty("--posx", "50%");
                        card.style.setProperty("--posy", "50%");
                    }, {
                        once: true
                    });
                });
            });
        });
    </script>

    <style>
        .employee-card-wrapper {
            perspective: 1000px;
        }

        .employee-card {
            transform-style: preserve-3d;
            transition: transform 0.5s ease-in-out;
            transform-origin: center;
        }

        .employee-card:hover {
            transform: rotateX(var(--rotateX)) rotateY(var(--rotateY)) translateX(var(--posx)) translateY(var(--posy));
        }
    </style>

{% endblock %}
